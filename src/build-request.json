{
  "kind": "build_request",
  "title": "Restore missing backend authorization modules to fix canister startup/connectivity",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Recreate the missing Motoko authorization module at `backend/authorization/access-control.mo` so that `backend/main.mo` can compile and the canister can start. The module must provide a non-trapping `initState()` function and the permission-checking functions used by `backend/main.mo` (at minimum: `hasPermission(state, caller, role)` and `isAdmin(state, caller)`), supporting the role tags referenced in `backend/main.mo` (`#admin` and `#user`).",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5",
          "msg-6"
        ],
        "quotes": [
          "The `authorization` modules your backend depends on are missing.",
          "backend/authorization/access-control.mo",
          "yes please"
        ]
      },
      "acceptanceCriteria": [
        "`dfx build` succeeds with the recreated `backend/authorization/access-control.mo` present.",
        "Canister initialization no longer traps due to `AccessControl.initState()` or missing symbols.",
        "All existing calls in `backend/main.mo` to `AccessControl.initState`, `AccessControl.hasPermission`, and `AccessControl.isAdmin` typecheck and run without trapping."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Recreate the missing Motoko authorization mixin at `backend/authorization/MixinAuthorization.mo` so that `backend/main.mo` can compile and include it (`include MixinAuthorization(accessControlState);`). The mixin must accept the access control state created by `AccessControl.initState()` and must not trap during actor initialization. Any public/shared/query methods exported by the mixin must be safe to call and must not require unavailable dependencies.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-5",
          "msg-6"
        ],
        "quotes": [
          "backend/authorization/MixinAuthorization.mo",
          "Just tell me if I should fix the authorization folder now.",
          "yes please"
        ]
      },
      "acceptanceCriteria": [
        "`dfx build` succeeds with the recreated `backend/authorization/MixinAuthorization.mo` present.",
        "The `include MixinAuthorization(accessControlState);` line in `backend/main.mo` compiles unchanged.",
        "Canister reaches Running state after deployment (no init-time trap attributable to the authorization mixin)."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single-actor architecture with all business logic in `backend/main.mo`.",
    "Do not modify files under `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`, or `frontend/src/components/ui`.",
    "Use English for any user-facing text."
  ],
  "nonGoals": [
    "Implementing new product features unrelated to authorization restoration.",
    "Refactoring existing resident/physician/pharmacy/insurance business logic in `backend/main.mo` beyond what is required to restore compilation and startup.",
    "Adding third-party authentication providers (only Internet Identity is supported)."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}